"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7231],{7231:(D,l,o)=>{o.r(l),o.d(l,{ScanResultPageModule:()=>b});var g=o(177),h=o(4341),r=o(1075),d=o(70),a=o(467),p=o(7464);const c=(0,p.F3)("BarcodeScanner",{web:()=>o.e(870).then(o.bind(o,870)).then(t=>new t.BarcodeScannerWeb)});var O=o(8254),n=o(4438),m=o(6648);let P=(()=>{class t{constructor(){}doPost(i,s,e){return(0,m.H)(p.pX.post({responseType:"json",url:i,headers:{"Accept-Encoding":"gzip","content-type":"application/json"},data:{access_token:"super_secure",host:s,external_id:e}}))}static#t=this.\u0275fac=function(s){return new(s||t)};static#n=this.\u0275prov=n.jDH({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const A=[{path:"",component:(()=>{class t{constructor(i,s,e){this.route=i,this.alertController=s,this.httpService=e,this.noResult=!0,this.isLoading=!0,this.driver="",this.postal_code="",this.isSupported=!1,this.organisation=""}ngOnInit(){this.getOrganisation(),c.isGoogleBarcodeScannerModuleAvailable().then(i=>{i&&c.installGoogleBarcodeScannerModule().then(s=>{})}),c.isSupported().then(i=>{this.isSupported=i.supported,this.scan()})}getOrganisation(){O.p.get({key:"organisation"}).then(i=>{console.log(i.value),this.organisation=i.value})}scan(){var i=this;return(0,a.A)(function*(){if(!(yield i.requestPermissions()))return void i.presentAlert();const{barcodes:e}=yield c.scan();yield i.getOrderData(e.pop().rawValue)})()}requestPermissions(){return(0,a.A)(function*(){const{camera:i}=yield c.requestPermissions();return"granted"===i||"limited"===i})()}presentAlert(){var i=this;return(0,a.A)(function*(){yield(yield i.alertController.create({header:"Permission denied",message:"Please grant camera permission to use the barcode scanner.",buttons:["OK"]})).present()})()}getOrderData(i){var s=this;return(0,a.A)(function*(){s.isLoading=!0,console.log("code "+i),s.httpService.doPost("https://tiramizoo-sorting-app-wjjudczu.herokuapp.com/api/scannings",s.organisation,i).subscribe(e=>{s.isLoading=!1,200!=e.status&&201!=e.status||""==e.data||null==e.data?s.noResult=!0:(s.noResult=!1,s.driver=e.data.courier_name,s.postal_code=e.data.delivery_postal_code)})})()}close(){var i=this;return(0,a.A)(function*(){i.route.navigateByUrl("/home",{replaceUrl:!0})})()}scanAgain(){var i=this;return(0,a.A)(function*(){i.getOrderData("123456")})()}static#t=this.\u0275fac=function(s){return new(s||t)(n.rXU(d.Ix),n.rXU(r.hG),n.rXU(P))};static#n=this.\u0275cmp=n.VBU({type:t,selectors:[["app-scan-result"]],decls:29,vars:7,consts:[["src","assets/logo_small.svg",1,"logo"],["name","circular",1,"loader",3,"hidden"],[3,"hidden"],[1,"value_container",3,"hidden"],[1,"label"],[1,"value"],[1,"separator"],[1,"value_div"],["src","assets/no_data_icon.svg",1,"img",3,"hidden"],[1,"error_text",3,"hidden"],[1,"button_container"],[1,"button_grey",3,"click"],[1,"button_center",3,"click"]],template:function(s,e){1&s&&(n.j41(0,"ion-content"),n.nrm(1,"ion-img",0)(2,"ion-spinner",1),n.j41(3,"div",2)(4,"div",3)(5,"div")(6,"div")(7,"ion-label",4),n.EFF(8,"Assigned driver"),n.k0s()(),n.j41(9,"div")(10,"ion-label",5),n.EFF(11),n.k0s()(),n.nrm(12,"div",6),n.k0s(),n.j41(13,"div",7)(14,"div")(15,"ion-label",4),n.EFF(16,"Delivery postal code"),n.k0s()(),n.j41(17,"div")(18,"ion-label",5),n.EFF(19),n.k0s()(),n.nrm(20,"div",6),n.k0s()(),n.nrm(21,"ion-img",8),n.j41(22,"h1",9),n.EFF(23,"This label does not belong to a package to be sorted."),n.k0s()(),n.j41(24,"div",10)(25,"ion-button",11),n.bIt("click",function(){return e.close()}),n.EFF(26,"Close"),n.k0s(),n.j41(27,"ion-button",12),n.bIt("click",function(){return e.scanAgain()}),n.EFF(28,"Next scan"),n.k0s()()()),2&s&&(n.R7$(2),n.Y8G("hidden",!e.isLoading),n.R7$(),n.Y8G("hidden",e.isLoading),n.R7$(),n.Y8G("hidden",e.noResult),n.R7$(7),n.JRh(e.driver),n.R7$(8),n.JRh(e.postal_code),n.R7$(2),n.Y8G("hidden",!e.noResult),n.R7$(),n.Y8G("hidden",!e.noResult))},dependencies:[r.Jm,r.W9,r.KW,r.he,r.w2],styles:["[hidden][_ngcontent-%COMP%]{display:none!important}ion-content[_ngcontent-%COMP%]{--ion-background-color:#FFF}.logo[_ngcontent-%COMP%]{display:block;margin-left:auto;margin-right:auto;padding-top:25%;width:40%}.img[_ngcontent-%COMP%]{display:block;margin-left:auto;margin-right:auto;padding-top:50%;width:30%}.error_text[_ngcontent-%COMP%]{text-align:center;font-size:20px;padding-left:5%;padding-right:5%;color:#8c8c8c}.loader[_ngcontent-%COMP%]{scale:200%;color:#1f1f1f;position:absolute;top:50%;left:50%}.button_container[_ngcontent-%COMP%]{position:absolute;width:80%;bottom:5%;left:50%;transform:translate(-50%,5%)}.value_container[_ngcontent-%COMP%]{position:absolute;width:80%;bottom:50%;left:50%;transform:translate(-50%,50%)}.label[_ngcontent-%COMP%]{font-size:18px;color:#8c8c8c}.value[_ngcontent-%COMP%]{font-weight:600;font-size:24px;color:#2c2c2c}.value_div[_ngcontent-%COMP%]{padding-top:40px}.separator[_ngcontent-%COMP%]{margin-top:10px;width:100%;height:1px;background:#ccc}.button_center[_ngcontent-%COMP%]{text-align:center;text-decoration:none;--border-radius: 7px;--padding-start: 30px;--padding-end: 30px;--padding-top: 10px;--padding-bottom: 10px;font-size:15px;width:140px;float:right}.button_grey[_ngcontent-%COMP%]{--background: #8C8C8C;text-align:center;text-decoration:none;--border-radius: 7px;--padding-start: 30px;--padding-end: 30px;--padding-top: 10px;--padding-bottom: 10px;font-size:15px;width:140px;margin-right:2%;float:left}"]})}return t})()}];let N=(()=>{class t{static#t=this.\u0275fac=function(s){return new(s||t)};static#n=this.\u0275mod=n.$C({type:t});static#i=this.\u0275inj=n.G2t({imports:[d.iI.forChild(A),d.iI]})}return t})(),b=(()=>{class t{static#t=this.\u0275fac=function(s){return new(s||t)};static#n=this.\u0275mod=n.$C({type:t});static#i=this.\u0275inj=n.G2t({imports:[g.MD,h.YN,r.bv,N]})}return t})()}}]);